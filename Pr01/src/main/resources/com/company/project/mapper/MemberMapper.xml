<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
SYSTEM
 "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.company.project.mapper.MemberMapper">
	<select id="getMember"
		resultType="com.company.project.dto.MemberDto">
		select * from member where email = #{email}
	</select>

	<select id="selectAllMember"
		resultType="com.company.project.dto.MemberDto">
		select * from member order by admin asc
	</select>
	
	<select id="selectSerchMember"
		resultType="com.company.project.dto.MemberDto">
		select * from member where admin = #{admin}
	</select>

	<select id="confirmEmail"
		resultType="com.company.project.dto.MemberDto">
		select email from member where email = #{email}
	</select>

	<insert id="insertMember">
		insert into member
		values(#{name}, #{email}, #{pwd}, #{phone}, #{admin})
	</insert>

	<update id="updateMember">
		update member set pwd= #{pwd},
		phone= #{phone},
		admin= #{admin}
		where email = #{email}
	</update>

	<delete id="memberDelete">
		delete from member where email = #{email}
	</delete>

	<select id="memberCount" resultType="com.company.project.dto.MemberCountDto">
		SELECT COUNT(*) as count, admin,
		CASE WHEN admin = 0 THEN 'manager'
		WHEN admin = 1 THEN 'employee'
		WHEN admin = 2 THEN 'user'
		END "position"
		FROM member group by admin, 
		CASE 
		WHEN admin = 0 THEN 'manager' 
		WHEN admin = 1 THEN 'employee' 
		WHEN admin = 2 THEN 'user' 
		END order by admin
	</select>

</mapper>